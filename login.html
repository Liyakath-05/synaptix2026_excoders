<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Login - PBR VITS SkillMatch AI</title>
</head>

<body class="login-page">

    <div class="inst-header">
        <img src="vitslogo.jpeg" class="logo" alt="PBR VITS Logo">
        <div class="header-content">
            <h1>PARVATHAREDDY BABUL REDDY</h1>
            <h2>VISVODAYA INSTITUTE OF TECHNOLOGY AND SCIENCE</h2>
            <p><b>(AUTONOMOUS)</b></p>
            <p>(Approved by AICTE, New Delhi, Accredited by NAAC and Permanently Affiliated to JNTUA, Ananthapuramu)</p>
            <p><b>KAVALI-524201, S.P.S.R Nellore Dist., A.P, India.</b></p>
        </div>
        <img src="founder.jpeg" class="founder" alt="Founder">
    </div>

    <div class="login-container">

        <div class="login-box" id="login-selection">
            <h2>Welcome to SkillMatch <span>AI</span></h2>
            <p>Please select your login type</p>
            <div class="btn-group">
                <button onclick="showForm('staff')">Staff Login</button>
                <button onclick="showForm('student')" class="secondary">Student Login</button>
            </div>
        </div>

        <div class="login-box hidden" id="staff-form">
            <h2>Staff Portal</h2>
            <input type="text" id="staff-id" placeholder="Staff ID">
            <input type="password" id="staff-pw" placeholder="Password">
            <button onclick="handleLogin('staff')">Login as Staff</button>
            <p onclick="location.reload()" class="back-link">← Back</p>
        </div>

        <div class="login-box hidden" id="student-form">
            <h2>Student Portal</h2>
            <input type="text" id="student-id" placeholder="Student Roll No">
            <input type="password" id="student-pw" placeholder="Password">
            <button onclick="handleLogin('student')">Login as Student</button>
            <p onclick="location.reload()" class="back-link">← Back</p>
        </div>

    </div>

    <script>
        function showForm(type) {
            document.getElementById('login-selection').classList.add('hidden');
            document.getElementById(type + '-form').classList.remove('hidden');
        }

        async function handleLogin(type) {
            const id = document.getElementById(type + '-id').value;
            const pw = document.getElementById(type + '-pw').value;

            try {
                const response = await fetch('http://127.0.0.1:8002/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        userid: id,
                        password: pw,
                        role: type
                    })
                });

                if (response.ok) {
                    sessionStorage.setItem('userType', type);
                    sessionStorage.setItem('userId', id);
                    window.location.href = 'index.html';
                } else {
                    alert("Invalid Credentials!");
                }
            } catch (e) {
                alert("Backend offline. Run main.py on port 8002.");
            }
        }
    </script>
</body>

</html>